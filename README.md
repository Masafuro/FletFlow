# FletFlow

[**English**](README_EN.md)

- FletFlowは、簡単に開発できる業務用の安定したリアルタイムシステムで、Flet GUIを活用し進捗追跡、状態更新、エラーハンドリングを提供します。

## FletFlowにおけるインターフェース分類

FletFlowでは、ユーザーインターフェース（UI）の要素を3つの主要なタイプに分類しています。この分類により、各UI要素の役割が明確化され、構造的なデザインとフロントエンド・バックエンド間のスムーズなデータフローが実現されます。

| タイプ             | 説明                                         | 役割                                                                                     | 例                                                   |
|--------------------|----------------------------------------------|------------------------------------------------------------------------------------------|------------------------------------------------------|
| **単純表示部**      | ユーザーの操作に影響されず、固定の内容を表示する要素。 | プログラム名や固定のテキスト、ロゴなど、インタラクティブでない基本情報を提供。              | アプリケーションのタイトル、著作権情報、装飾画像       |
| **可変表示部**      | ユーザーの入力や選択によって内容が変化する要素。     | ユーザーの入力や選択内容を保持し、後の処理に利用できるようにする。                         | カレンダー入力、トグル/スイッチ、カウンター、テキストフィールド |
| **処理実行部**      | 可変表示部の入力に基づいてデータ処理を開始する要素。  | トリガーとして機能し、可変表示部に保持されたデータをバックエンドに送信。                    | 実行ボタン、リセットボタン                              |

## FletFlowにおけるデータ送受信モード

FletFlowでは、実行ボタンなどの処理実行部のUIがユーザーによって押されると、システムは**データ送受信モード**に移行します。このモードでは、可変表示部のデータがPythonの`multiprocessing`モジュールを使用して別プロセスで起動しているバックエンドシステムに送信されます。これにより、ユーザーインターフェースをブロックせずにスムーズなデータ処理が可能になります。

### 送受信に使用されるデータテーブル

FletFlowでは、GUIとバックエンドの間で信頼性のある通信を行うため、構造化されたデータテーブルを使用します。GUIとバックエンド間でやり取りされる各メッセージは、以下のデータテーブル形式に従います。このテーブルには、メッセージの種類、コマンド、状態、データ内容、および追加の詳細情報などが含まれています。

| フィールド名       | 説明                                               | 例                                                |
|--------------------|----------------------------------------------------|---------------------------------------------------|
| `type`            | メッセージの種類を指定                              | `"request"`、`"response"`、`"complete"`            |
| `command`         | 実行するアクションや関数を指定                      | `"calculate"`、`"update_status"`                  |
| `status`          | 処理の進捗やレスポンスの状態を示す                   | `"progress"`、`"success"`、`"error"`              |
| `data`            | 処理に必要なコアデータを含む                         | `{"operand1": 5, "operand2": 3, "operation": "multiply"}` |
| `details`         | 追加情報やエラーメッセージを提供                     | `"Calculation completed."`、`"Invalid input"`     |

## データ送受信モードにおける通信フロー

FletFlowのデータ送受信モードにおける通信フローは、以下のステップにまとめられます。この表では、各ステップの目的と役割を示し、フロントエンドとバックエンド間の円滑でリアルタイムな通信を実現します。

| ステップ                             | 説明                                                                                                         | 目的                                                                                         |
|-------------------------------------|--------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------|
| **1. データ送受信モードに移行**       | ユーザーが処理実行部を操作すると、GUIがデータ送受信モードに移行し、データの送信準備を行います。                 | 可変表示部のデータをバックエンド処理用に準備し、通信を開始。                                  |
| **2. データをバックエンドに送信**      | GUIが`multiprocessing`を使用してバックエンドにデータを送信し、構造化されたデータテーブル形式に従います。         | 信頼性のある通信のために、一貫したデータ構造を提供。                                          |
| **3. バックエンド処理**               | バックエンドがデータを受信し、指定されたコマンドを処理し、進捗やエラーに応じた複数の`response`メッセージを送信。 | リアルタイムでの更新、進捗、エラー情報を提供。                                                |
| **4. リアルタイムレスポンス処理**      | GUIが`response`メッセージを継続的にリッスンし、`status`や`data`に基づきUI要素を更新。                          | 最新のステータス、進捗、エラーを反映してUIを動的に更新。                                      |
| **5. データ送受信モードの終了**        | `complete`メッセージを受信後、GUIがデータ送受信モードを終了し、ユーザー操作が再び有効化されます。                 | プロセスを終了し、UIの操作性を復元して次の操作を可能にする。                                   |

この表により、FletFlowが応答性と信頼性を保ちながら、複雑なリアルタイムインタラクションに対応する通信フローが示されています。
